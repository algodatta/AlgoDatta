resource "aws_route53_record" "dkim" { count=3 zone_id=var.zone_id name="${element(var.dkim_tokens,count.index)}._domainkey.${var.root_domain}" type="CNAME" ttl=300 records=["${element(var.dkim_tokens,count.index)}.dkim.amazonses.com"] } locals { mail_from_fqdn="${var.mail_from_subdomain}.${var.root_domain}" } resource "aws_route53_record" "mail_from_mx" { zone_id=var.zone_id name=local.mail_from_fqdn type="MX" ttl=300 records=["10 feedback-smtp.${var.aws_region}.amazonses.com"] } resource "aws_route53_record" "mail_from_spf" { zone_id=var.zone_id name=local.mail_from_fqdn type="TXT" ttl=300 records=["v=spf1 include:amazonses.com -all"] } resource "aws_route53_record" "dmarc" { zone_id=var.zone_id name="_dmarc.${var.root_domain}" type="TXT" ttl=300 records=["v=DMARC1; p=none; rua=mailto:${var.dmarc_rua}; fo=1; pct=100"] }